$(function(){var t=window.localStorage;$.ajax({url:"../json/dataz.json",success:function(e){for(var a=e.data,n="",s=0;s<t.length;s++)for(var l in a)t.key(s)==a[l].id&&(n+='<div class="goods">',n+='<span class="select"></span>',n+="<dl>",n+='<dt><img src="../img/'+a[l].img+'"/></dt>',n+="<dd>",n+="<p>"+a[l].name+"</p>",n+='<p class="price">'+a[l].price+"</p>",n+='<input dataid="'+a[l].id+'" class="reduce" type="button" value="-"/>',n+='<input  class="num" type="text" value="'+localStorage.getItem("n"+a[l].id)+'"/>',n+='<input dataid="'+a[l].id+'" class="add" type="button" value="+"/>',n+="</dd>",n+="</dl>",n+='<i class="delet" dataid="'+a[l].id+'"></i>',n+='<div class="addprice"></div>',n+="</div>");$(".content").append(n),$(".footer").on("click",".select",function(){var t=0,e=0;if($(this).hasClass("active"))$(this).removeClass("active"),$(".content .select").removeClass("active"),$(".paynum").html(t),$(".sum span").html(e);else{$(this).addClass("active"),$(".content .select").addClass("active");for(var a=0;a<$(".content .select").size();a++)t+=parseInt($(".content .select").eq(a).next().find(".num").val()),e+=$(".content .select").eq(a).next().find(".num").val()*$(".content .select").eq(a).next().find(".price").html();$(".paynum").html(t),$(".sum span").html(e)}}),$(".content").on("click",".select",function(){var t=0,e=0,a=parseInt($(".paynum").html()),n=parseInt($(".sum span").html());if($(this).hasClass("active"))$(this).removeClass("active"),$(".footer .select").removeClass("active"),t=a-parseInt($(this).next().find(".num").val()),$(".paynum").html(t),e=n-$(this).next().find(".num").val()*$(this).next().find(".price").html(),console.log(e),$(".sum span").html(e);else{$(this).addClass("active"),$(".footer .select").removeClass("active"),t=a+parseInt($(this).next().find(".num").val()),$(".paynum").html(t),e=n+parseInt($(this).next().find(".num").val()*$(this).next().find(".price").html()),$(".sum span").html(e);for(var s=0;s<$(".content .select").size();s++)if(!$(".content .select").eq(s).hasClass("active"))return;$(".footer .select").addClass("active")}}),$(".goods .add").click(function(){var t=$(this).prev().val(),e=$(".paynum").html(),a=parseInt($(".sum span").html());t++,$(this).prev().val(t),$(this).parent().parent().prev().hasClass("active")&&(e++,$(".paynum").html(e),a+=parseFloat($(this).parent().find(".price").html()),$(".sum span").html(a));var n=$(this).attr("dataid");localStorage.setItem("n"+n,t)}),$(".goods .reduce").click(function(){var t=$(this).next().val(),e=$(".paynum").html(),a=parseFloat($(".sum span").html());t--,t<1?t=1:(e--,$(this).parent().parent().prev().hasClass("active")&&(a-=parseFloat($(this).parent().find(".price").html()),$(".sum span").html(a),$(".paynum").html(e))),$(this).next().val(t);var n=$(this).attr("dataid");localStorage.setItem("n"+n,t)}),$(".goods").on("click",".delet",function(){$(this).parents(".goods").remove();var t=$(this).attr("dataid");localStorage.removeItem(t),localStorage.removeItem("n"+t);var e=0,a=0,n=parseInt($(".paynum").html()),s=parseInt($(".sum span").html());e=n-parseInt($(this).parent().find(".num").val()),a=s-$(this).parent().find(".num").val()*$(this).parent().find(".price").html(),$(this).parent().find(".select").hasClass("active")&&($(".paynum").html(e),$(".sum span").html(a))}),$(".grzx").click(function(){var t=localStorage.getItem("login");t?window.location.href="clearinghouse.html":window.location.href="login.html"}),$(".header").on("click",".back",function(){window.location.href="detail.html"});var i=!1;$(".header").on("click",".menu",function(){i?($(".list").hide(),i=!1):($(".list").show(),i=!0)}),$(".toindex").click(function(){window.location.href="../index.html"}),$(".tosearch").click(function(){window.location.href="classify.html"}),$(".toshopcar").click(function(){window.location.href="shopcar.html"})}})}),$(function(){$("#all .footer").on("click",".goto",function(){var t=$("#all .footer .sum span").html();localStorage.allprice=t})});